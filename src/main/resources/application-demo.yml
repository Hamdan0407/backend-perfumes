spring:
  application:
    name: perfume-shop
  
  # ==========================================
  # DATABASE CONFIGURATION - H2 IN-MEMORY FOR DEMO
  # ==========================================
  datasource:
    url: jdbc:h2:mem:perfume_shop;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=false
    username: sa
    password: 
    driver-class-name: org.h2.Driver
    
    # Connection Pool Settings
    hikari:
      maximum-pool-size: 10
      minimum-idle: 3
      connection-timeout: 10000
      idle-timeout: 300000
      max-lifetime: 1800000
      connection-test-query: "SELECT 1"
      auto-commit: true
  
  h2:
    console:
      enabled: true
      path: /h2-console
  
  # ==========================================
  # JPA & HIBERNATE CONFIGURATION - H2 DEMO MODE
  # ==========================================
  jpa:
    hibernate:
      ddl-auto: create
    
    defer-datasource-initialization: true
    show-sql: false
    
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.H2Dialect
        use_sql_comments: false
        
        # Performance tuning
        jdbc:
          batch_size: 20
          fetch_size: 50
        order_inserts: true
        order_updates: true
        
        # Connection validation
        generate_statistics: false
  
  # ==========================================
  # EMAIL CONFIGURATION - DEMO MODE
  # Log to console instead of sending real emails
  # ==========================================
  mail:
    host: ${MAIL_HOST:localhost}
    port: ${MAIL_PORT:1025}
    username: ${MAIL_USERNAME:demo@localhost}
    password: ${MAIL_PASSWORD:demo_password}
    protocol: smtp
    properties:
      mail:
        smtp:
          auth: false
          starttls:
            enable: false
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
          # Demo mode: don't actually send, just log
          transport:
            protocol: smtp
    default-encoding: UTF-8

# ==========================================
# CUSTOM APPLICATION PROPERTIES
# ==========================================
app:
  email:
    enabled: ${MAIL_ENABLED:false}
    log-only: ${EMAIL_LOG_ONLY:true}
    max-retries: ${EMAIL_MAX_RETRIES:1}
    retry-delay-ms: ${EMAIL_RETRY_DELAY:5000}
  
  security:
    jwt:
      secret: ${JWT_SECRET:demo_jwt_secret_key_for_local_testing_only_min_256_bits_required}
      expiration: ${JWT_EXPIRATION:86400000}
      refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000}
      grace-period: ${JWT_GRACE_PERIOD:60000}
  
  payment:
    razorpay:
      enabled: ${RAZORPAY_ENABLED:true}
      key-id: ${RAZORPAY_KEY_ID:rzp_test_placeholder_key_id}
      key-secret: ${RAZORPAY_KEY_SECRET:rzp_test_placeholder_key_secret}
      webhook-secret: ${RAZORPAY_WEBHOOK_SECRET:rzp_test_placeholder_webhook_secret}
      currency: ${RAZORPAY_CURRENCY:INR}
    
    stripe:
      enabled: ${STRIPE_ENABLED:false}
      api-key: ${STRIPE_API_KEY:sk_test_placeholder}
      publishable-key: ${STRIPE_PUBLISHABLE_KEY:pk_test_placeholder}
  
  cors:
    origins: ${CORS_ORIGINS:http://localhost:3000,http://localhost:80,http://localhost:8080}
    max-age: ${CORS_MAX_AGE:3600}
  
  frontend:
    url: ${FRONTEND_URL:http://localhost:3000}
  
  demo:
    enabled: ${DEMO_MODE:true}
    sample-data: ${DEMO_SAMPLE_DATA:true}

# ==========================================
# LOGGING CONFIGURATION - DEMO MODE
# More verbose for debugging
# ==========================================
logging:
  level:
    root: ${LOG_LEVEL:INFO}
    com.perfume.shop: DEBUG
    org.springframework.web: INFO
    org.hibernate: INFO
  
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  
  file:
    name: logs/perfume-shop-demo.log
    max-size: 10MB
    max-history: 5

# ==========================================
# SERVER CONFIGURATION
# ==========================================
server:
  port: ${PORT:8080}
  servlet:
    context-path: /
  error:
    include-message: always
    include-binding-errors: always
    include-stacktrace: on-param
    include-exception: false
  compression:
    enabled: true
    min-response-size: 1024

# ==========================================
# ACTUATOR ENDPOINTS - FOR MONITORING
# ==========================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      simple:
        enabled: true
